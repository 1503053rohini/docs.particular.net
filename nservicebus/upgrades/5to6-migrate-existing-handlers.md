---
title: Migrate handlers/sagas to Version 6
reviewed: 2016-08-29
---

In previous versions of NServiceBus, a typical handler class looks like the below:

snippet:5to6-handler-migration-beginning

Implement the new `IHandleMessages` interface. Remove any code that is generated by the IDE or additional tools like Resharper and mark the new `Handle` method as `async` by adding the `async` keyword.

snippet:5to6-handler-migration-step1

Rename the bus property or the bus constructor parameter to `context`. Although the [IBus interface has been deprecated](/nservicebus/upgrades/5to6-moving-away-from-ibus.md) and can be safely removed, for this step renaming the property instead of deleting it comes in useful when refactoring existing code. It's much easier to rename all the existing references from `bus` property to `context`.

snippet:5to6-handler-migration-step2

Inline or "cut-and-paste" the old `Handle` method code into the new asynchronous `Handle` method. When the code is compiled a compiler warning [`CS4014`](https://msdn.microsoft.com/en-us/library/hh873131.aspx) will be shown indicating that there are asynchronous methods in the handler which are not awaited.

snippet:5to6-handler-migration-step3

Fix the compiler warnings by introducing the `await` statement followed by `ConfigureAwait(false)` to each asynchronous method call.

NOTE: Visual Studio 2015 and higher has the capability to automatically fix those warnings with the [`Ctrl+.`](https://msdn.microsoft.com/en-us/library/dn872466.aspx) (depending on the keybindings) shortcut. It is even possible to fix it in the whole solution if desired.

snippet:5to6-handler-migration-step4

After these steps start moving other code in the handler towards async if the code supports it when it is desired to fully leverage async/await. For example with Entity Framework instead of calling `SaveChanges` call `SaveChangesAsync` on the database context.
